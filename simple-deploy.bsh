#!/bin/bash
# ã‚·ãƒ³ãƒ—ãƒ«è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆBashç‰ˆï¼‰
# ä½¿ç”¨æ–¹æ³•: ./simple-deploy.sh

echo "ğŸš€ Claude Code ç°¡æ˜“ãƒ‡ãƒ—ãƒ­ã‚¤é–‹å§‹"
echo "================================"

# ç¾åœ¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨æ™‚åˆ»è¡¨ç¤º
echo "ğŸ“ ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: $(pwd)"
echo "ğŸ•’ å®Ÿè¡Œæ™‚åˆ»: $(date '+%Y-%m-%d %H:%M:%S')"

# ================================================
# ğŸ“ æ¯å›ã“ã“ã‚’ç·¨é›†ã—ã¦ãã ã•ã„ï¼
# ================================================
# 
# ä¾‹ï¼š
# COMMIT_MESSAGE="Add dark mode feature to weather app"
# COMMIT_MESSAGE="Fix mobile responsive layout issues"
# COMMIT_MESSAGE="Update API error handling and user feedback"
# COMMIT_MESSAGE="Improve weather icons and animations"
# 
#COMMIT_MESSAGE="re-modified 2048 puzzle game to project"
 COMMIT_MESSAGE="upload swim Record app"
# 
# ================================================

echo ""
echo "ğŸ’¬ ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: $COMMIT_MESSAGE"
echo ""

# Gitãƒªãƒã‚¸ãƒˆãƒªç¢ºèª
if [ ! -d .git ]; then
    echo "âŒ ã‚¨ãƒ©ãƒ¼: Gitãƒªãƒã‚¸ãƒˆãƒªã§ã¯ã‚ã‚Šã¾ã›ã‚“"
    echo "   claude-code-testãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§å®Ÿè¡Œã—ã¦ãã ã•ã„"
    exit 1
fi

# å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
echo "ğŸ“‹ å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«:"
GIT_STATUS=$(git status --porcelain)

if [ -z "$GIT_STATUS" ]; then
    echo "âš ï¸  å¤‰æ›´ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™ã€‚"
    exit 0
fi

git status --short

echo ""
echo -n "ğŸ”„ ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’å®Ÿè¡Œã—ã¾ã™ã‹? (y/N): "
read -r CONFIRM

if [[ ! "$CONFIRM" =~ ^[Yy]$ ]]; then
    echo "âŒ ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã—ãŸ"
    exit 0
fi

echo ""
echo "â³ Gitæ“ä½œã‚’å®Ÿè¡Œä¸­..."

# Gitæ“ä½œå®Ÿè¡Œ
echo "1ï¸âƒ£ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°..."
if ! git add .; then
    echo "âŒ git add ã«å¤±æ•—ã—ã¾ã—ãŸ"
    exit 1
fi

echo "2ï¸âƒ£ ã‚³ãƒŸãƒƒãƒˆä½œæˆ..."
if ! git commit -m "$COMMIT_MESSAGE"; then
    echo "âŒ git commit ã«å¤±æ•—ã—ã¾ã—ãŸ"
    exit 1
fi

echo "3ï¸âƒ£ GitHubã«ãƒ—ãƒƒã‚·ãƒ¥..."
if ! git push origin main; then
    echo "âŒ git push ã«å¤±æ•—ã—ã¾ã—ãŸ"
    exit 1
fi

echo ""
echo "âœ… ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†ï¼"

# ãƒªãƒã‚¸ãƒˆãƒªæƒ…å ±å–å¾—
REPO_URL=$(git remote get-url origin)
USERNAME=$(echo "$REPO_URL" | sed 's/.*github\.com[\/:]//g' | sed 's/\/.*//g')
REPO_NAME=$(echo "$REPO_URL" | sed 's/.*\///g' | sed 's/\.git//g')

echo ""
echo "ğŸ“± ã‚¢ãƒ—ãƒªURL:"
echo "   https://$USERNAME.github.io/$REPO_NAME/"

if [ -d MinatoSwimRecord-app ]; then
    echo "   https://$USERNAME.github.io/$REPO_NAME/MinatoSwimRecord-app/"
fi

echo "   https://$USERNAME.github.io/$REPO_NAME/weather-app/"

if [ -d game-app ]; then
    echo "   https://$USERNAME.github.io/$REPO_NAME/game-app/"
fi

echo ""
echo "â° GitHub Pagesã®æ›´æ–°ã¾ã§ç´„5åˆ†ãŠå¾…ã¡ãã ã•ã„"
echo "ğŸ”„ æ›´æ–°çŠ¶æ³: https://github.com/$USERNAME/$REPO_NAME/actions"
echo ""
echo "ğŸ‰ Happy Coding! ğŸš€"
echo "================================"
